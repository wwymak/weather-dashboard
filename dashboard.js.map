{"version":3,"sources":["dashboard.es6.js"],"names":[],"mappings":"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","file":"dashboard.js","sourcesContent":["/**\n * Main file for the charting of weather data(quick prototype)\n *\n * idea: main chart to have temp as time series, grouped by day of year\n * at the moment only day of year implemented but may be nice to be able\n * to be zoomable into minute detail\n * -- would be really cool to do something along the lines of http://bl.ocks.org/emeeks/b57f4cc89dacd38fcdcd\n * the big radar chart would control all the smaller 'cards'\n *\n * (showing pattern in rainfall and temp, which most people are interested in\n * rainfall + temp so you can know whetehr it's generally cold and wet/ hot and wet, vice versa etc\n *\n *\n * secondary charts:\n * wind direction distrubution average for the date range selected with brush (radar chart)\n *\n * battery level vs solar flux (not implemented yet)\n *\n * needs a data loading spinner\n *\n * want some sort of headline 'status now values' at top of board\n * e.g. ON THIS DAY, rainfall is x, temp is y and wind direction is z degrees\n *\n * simple sketch/prototype for now. To make it more scaleable would probably want\n * different modules for data parsing, possibly componentising each chart/ chartype\n * would also be useful to be handle different data types etc\n */\n\n(function() {\n  //data utils, params\n  let dateFormatter = d3.time.format('%Y/%m/%d %H:%M');\n  let xFilter; //crossfilter\n  let dayDimension, weekDimension, solarFluxDimension, windDirDimension; //dimensions- basically what you want as x values\n  let dayTempGroup, rainFallGroup, windDirGroup; //xfilter groups\n\n  //charting params\n  let tempChart, batteryChart, rainfallChart, windChart; // types of charts\n  let transitionDuration = 500; //default transition times for chart zooming etc\n\n  /**\n   * initialises the dashboard elements that dc draws, setting the height and width\n   * dynamically so on window resize the chart redraws according to new dimensions\n   */\n  function dashboardInit() {\n    let tempChartWidth = document.getElementById('tempChart').offsetWidth,\n        tempChartHeight = tempChartWidth * 0.5,\n        rainFallChartWidth = document.getElementById('rainfallChart').offsetWidth,\n        rainFallChartHeight = rainFallChartWidth * 0.5;\n    tempChart = dc.lineChart('#tempChart')\n        .width(tempChartWidth)\n        .height(tempChartHeight)\n        .transitionDuration(transitionDuration)\n        .margins({top: 30, right: 50, bottom: 25, left: 40});\n    rainfallChart = dc.barChart('#rainfallChart')\n        .width(rainFallChartWidth)\n        .height(rainFallChartHeight)\n        .transitionDuration(10)\n        .margins({top: 30, right: 50, bottom: 25, left: 40});\n    //batteryChart = dc.lineChart('#batteryChart');\n  }\n\n  /**\n   * get the csv data using d3.promise, then do a few bits of parsing\n   * @returns {Promise.<T>} with the parsed data for chaining and further ops\n   */\n  function getData() {\n    return d3.promise.csv('JCMB_2015.csv').then(data => {\n      data.forEach(d => {\n        d.dateTime = dateFormatter.parse(d.dateTime);\n        Object.keys(d).forEach((key) => {\n          if (d.hasOwnProperty(key) && key !== \"dateTime\") {\n            d[key] = +d[key];\n          }\n        });\n        if (d.windDir >= 360) {\n          d.windDir = d.windDir % 360;\n        }\n        d.day = d3.time.day(d.dateTime);\n        d.week = d3.time.week(d.dateTime);\n        d.windDirType = Math.floor(d.windDir / 45);//classify the wind direction into 1 of 8 quadrants\n      });\n      return data\n    }, (err) => {\n      alert(\"problem fetching data, please reload page\");\n    });\n  }\n\n  /**\n   * takes the parsed data and creates a xFilter\n   * @param data array of data objects, e.g. as returned from d3.csv\n   */\n  function setXfilter(data) {\n    xFilter = crossfilter(data);\n    dayDimension = xFilter.dimension(d => d.day);\n    weekDimension = xFilter.dimension(d => d.week);\n    solarFluxDimension = xFilter.dimension(d => d.solarFlux);\n    windDirDimension = xFilter.dimension(d => d.windDirType);\n\n    dayTempGroup = dayDimension.group().reduce((p, v) => {\n      ++p.count;\n      p.totalTemp += v.surfTemp;\n      p.avgTemp = p.totalTemp / p.count;\n      return p\n    }, (p, v) => {\n      --p.count;\n      p.totalTemp -= v.surfTemp;\n      p.avgTemp = p.totalTemp / p.count;\n      return p\n    }, () => {\n      return {\n        count: 0,\n        totalTemp: 0,\n        avgTemp: 0\n      }\n    });\n\n    rainFallGroup = weekDimension.group().reduceSum(d => d.rainfall);\n    windDirGroup = windDirDimension.group().reduceCount();\n  }\n\n  /**\n   * draws the dc charts and the wind radarChart\n   * @param data parsed data e.g. from d3.csv, but only call after the dimensions\n   * and groups fro dc has been created\n   */\n  function chartRender(data) {\n    let minDate = d3.min(data, d => d.dateTime),\n        maxDate = d3.max(data, d => d.dateTime);\n    tempChart\n        .dimension(dayDimension)\n        .group(dayTempGroup)\n        .brushOn(true)\n        .valueAccessor(d => d.value.avgTemp)\n        .x(d3.time.scale().domain([minDate, maxDate]))\n        .yAxisLabel('degrees Celcius')\n        .renderTitle(true)\n        .title(d => `${d.key}\\n ${d.value}degrees`)\n        .on('filtered', () => {\n          console.log('filtered', rainFallGroup.all(), windDirGroup.reduceCount().all())\n          d3.select('#windDirChart').datum(windDirGroup.reduceCount().all()).call(radarChart());\n        });\n\n    tempChart.brush().on('brushend', () => {\n      console.log('brushend')\n    })\n\n    rainfallChart\n        .dimension(weekDimension)\n        .group(rainFallGroup)\n        .valueAccessor(d => d.value)\n        .yAxisLabel('mm')\n        .brushOn(false)\n        .x(d3.time.scale().domain([minDate, maxDate]))\n        .xUnits(d3.time.weeks)\n        .elasticY(true)\n        .elasticX(true);\n\n    windChart = d3.select('#windDirChart').datum(windDirGroup.all())\n        .call(radarChart().width(document.getElementById('windDirChart').offsetWidth)\n            .height(document.getElementById('windDirChart').offsetWidth));\n    dc.renderAll();\n  }\n\n//radarChart for windDirection data -- as a reusable component\n  function radarChart() {\n    let width = 400,\n        height = 400,\n        margin = 40,\n        angleScale = d3.scale.linear().range([0, 2 * Math.PI]),\n        radiusScale = d3.scale.linear().range([0, d3.min([height, width]) / 2 - margin]),\n        colorScale = d3.scale.category20(); //temp colors-- don't look super great tbh,\n\n    let stackFunc = d3.layout.stack().values(d => d.values);\n\n    function chart(selection) {\n      let svg;\n      //assuming that data is in the format of array with [{key: .., value:...}, ...]\n      selection.each((data) => {\n        //select the svg if it exists\n        svg = this.selectAll(\"svg.radarchart\").data([data]);\n        console.log(data, svg, d3.max(data, d => d.value))\n        //or add a new one if not\n        let newSVG = svg.enter().append('svg').attr('class', 'radarchart');\n\n        svg.attr(\"width\", width)\n            .attr(\"height\", height);\n\n        angleScale.domain([0, data.length]);\n        radiusScale.domain([0, d3.max(data, d => d.value)]);\n\n        newSVG.append('g').attr('class', 'radial-bars')\n            .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');\n\n        let radialG = d3.selectAll('.radial-bars');\n\n        drawRadialBars(data);\n        drawRadialAxis();\n\n        function drawRadialBars(data) {\n          let arc = d3.svg.arc().startAngle((d, i) => angleScale(i))\n              .endAngle((d, i) => angleScale(i + 1))\n              .innerRadius(0)\n              .outerRadius(d => radiusScale(d.value));\n          let radarSectors = radialG.selectAll('path').data(data)\n\n          radarSectors.enter().append('path');\n\n          radarSectors.attr('d', arc).attr('class', 'radial-sector')\n              .attr('fill', (d, i) => colorScale(i));\n        }\n\n        function drawRadialAxis() {\n          let rAxisVals = d3.range(3).map(function (d) {\n            return (d + 1) * radiusScale.domain()[1] / 3\n          });\n\n          let radialAxis = radialG.selectAll('circle.raxis').data(rAxisVals);\n          radialAxis.enter().append('circle')\n          radialAxis.attr('r', d => radiusScale(d))\n              .attr('cx', 0).attr('cy', 0)\n              .attr('class', 'raxis');\n\n          let radialLabels = radialG.selectAll('text').data(rAxisVals);\n          radialLabels.enter().append('text');\n          radialLabels.attr('x', 0).attr('y', d =>radiusScale(d))\n              .text(d => Math.round(radiusScale(d)))\n        }\n\n      })\n    }\n\n    //getters and setters\n    chart.width = function (val) {\n      if (!arguments.length) {\n        return width;\n      }\n      width = val;\n      return chart;\n    };\n\n    chart.height = function (val) {\n      if (!arguments.length) {\n        return height;\n      }\n      height = val;\n      return chart;\n    };\n\n    chart.margin = function (val) {\n      if (!arguments.length) {\n        return margin;\n      }\n      margin = val;\n      return chart;\n    };\n\n    return chart\n  }\n\n//todo dcjs don't seem to like the resizing very much...\n  function windowResizeHandler() {\n    //debounce function, basically redraw the chart on resize but only after you've\n    //finished resizing\n    let resizeTimer;\n    window.onresize = ((e) => {\n      clearTimeout(resizeTimer);\n      resizeTimer = setTimeout(() => {\n        //dashboardInit();\n        dc.redrawAll();\n      }, 250);\n    });\n\n  }\n\n  //set up dashboard\n  dashboardInit();\n  //grab the data, parse, then render chart\n  getData().then(data => {\n        setXfilter(data);\n        return data\n      }, err => {\n        console.log(err)\n      })\n      .then((data) => {\n        chartRender(data)\n      });\n})();"]}